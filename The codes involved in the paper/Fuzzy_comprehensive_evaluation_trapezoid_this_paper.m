clc
clear all
data = [1602.111009	11.81738226	3.416204198	12.96462712
1588.887621	11.86746936	3.398764812	12.93655043
1575.664233	11.96764355	3.385045119	12.90847375
1562.440846	11.91755645	3.396132543	13.03670431
1549.217458	11.82331278	3.387605733	13.02516544
1535.99407	11.98543513	3.375857163	13.01939601
1530.12785	12.14755747	3.365931347	13.01362658
1530.624832	12.30967981	3.356005531	13.00785715
1531.121815	12.47180216	3.348607972	13.06925959
1531.618797	12.6339245	3.32861539	13.09460021
1532.11578	12.64570146	3.340583814	13.07751982
1536.111821	12.6815626	3.335304934	13.128761
1526.083379	12.71459936	3.330026055	13.04335903
1516.054938	12.72003081	3.324747175	13.02078049
1506.026496	12.74237282	3.319468295	12.9927038
1495.998054	12.75328486	3.314189416	13.19783392
1490.652458	12.77184783	3.288371984	13.32640825
1489.326958	12.79775634	3.27291999	13.45498258
1488.664209	12.82366484	3.267467995	13.58355691
1487.338709	12.84957335	3.2582016	13.71213124
1476.5652	13.1306955	3.247803912	14.14284503
1466.259981	13.24280703	3.235584625	14.26072005
1457.975494	13.37254451	3.173130127	14.37859506
1449.691007	13.30228199	3.170675628	14.39929718
1433.122033	13.23201947	3.116822113	14.46514022
1424.837546	13.36175695	3.06576663	14.49647008
1417.728141	13.32562083	3.064723362	14.53758853
1411.793818	13.36014082	3.065459286	14.6143451
1405.859496	13.39169545	3.06619521	14.73222011
1399.925174	13.427273	3.066563172	14.75493346
1393.990851	13.455265	3.088777256	14.68248515
1388.056529	13.4785072	2.936041288	14.61003684
1379.70116	13.51563623	2.920717051	14.58809592
1350.483523	13.54478909	2.874683251	14.83883102
1347.524998	13.58987512	2.780189669	15.00530697
1359.009583	13.61008247	2.870626291	14.93150044
1300.93926	13.72525	2.877812001	15.16616085
1263.073495	13.78254	2.786399494	15.187458
1249.256065	13.97795349	2.7522	14.91787624
1234.773841	14.38921531	2.745426	14.9852
1228.616	14.64461664	2.760176645	15.06893514
1222.458159	14.54284207	2.728081801	15.04315674
1196.451	14.60108793	2.657744012	14.9814594
1224.0249	14.56472408	2.69806978	15.16616085
1158.28281	14.8603695	2.726901828	15.187458
1149.332685	15.08003895	2.598208698	15.71844811
1094.191926	15.48484031	2.618232183	16.10442211
1078.673618	15.90428056	2.4865	16.40204538
1030.387896	16.08590457	2.369012745	17.90616515
1041.855358	15.91923996	2.242028871	18.60595392];
% 将第1和第3列转换为负值
data(:, [1, 3]) = -data(:, [1, 3]);
x0 = data(:, 1:4);
m = size(x0, 1);
a1 = -1600; b1 = -1530; c1 = -1490; d1 = -1400; e1 = -1230; f1 = -1040;
a2 = 11.8; b2 = 12.6; c2 = 12.9; d2 = 13.5; e2 = 14.5; f2 = 16;
a3 = -3.4; b3 = -3.34; c3 = -3.25; d3 = -3.05; e3 = -2.75; f3 = -2.25;
a4 = 12.9; b4 = 13.1; c4 = 14; d4 = 14.8; e4 =15.2; f4 = 18.5;

for i = 1:1:m
    % 1.结合时间偏移量(-)
    % disp('隶属度函数等级为5')
    if x0(i, 1) <= a1
        A15(i, 1) = 1;
    elseif x0(i, 1) > a1 & x0(i, 1) < b1
        A15(i, 1) = (b1 - x0(i, 1)) / (b1 - a1);
    else
        A15(i, 1) = 0;
    end
    % disp('隶属度函数等级为4')
    if x0(i, 1) > a1 & x0(i, 1) < b1
        A14(i, 1) = (x0(i, 1) - a1) / (b1 - a1);
    elseif x0(i, 1) >= b1 & x0(i, 1) < c1
        A14(i, 1) = 1;
    elseif x0(i, 1) >= c1 & x0(i, 1) < d1
        A14(i, 1) = (d1 - x0(i, 1)) / (d1 - c1);
    else
        A14(i, 1) = 0;
    end
    % disp('隶属度函数等级为3')
    if x0(i, 1) > b1 & x0(i, 1) < c1
        A13(i, 1) = (x0(i, 1) - b1) / (c1 - b1);
    elseif x0(i, 1) >= c1 & x0(i, 1) < d1
        A13(i, 1) = 1;
    elseif x0(i, 1) >= d1 & x0(i, 1) < e1
        A13(i, 1) = (e1 - x0(i, 1)) / (e1 - d1);
    else
        A13(i, 1) = 0;
    end
    % disp('隶属度函数等级为2')
    if x0(i, 1) >= c1 & x0(i, 1) < d1
        A12(i, 1) = (x0(i, 1) - c1) / (d1 - c1);
    elseif x0(i, 1) > d1 & x0(i, 1) < e1
        A12(i, 1) = 1;
    elseif x0(i, 1) >= e1 & x0(i, 1) < f1
        A12(i, 1) = (f1 - x0(i, 1)) / (f1 - e1);
    else
        A12(i, 1) = 0;
    end
   % disp('隶属度函数等级为1')
    if x0(i, 1) > e1 & x0(i, 1) < f1
        A11(i, 1) = (x0(i, 1) - e1) / (f1 - e1);
    elseif x0(i, 1) >= f1
        A11(i, 1) = 1;
    else
        A11(i, 1) = 0;
    end
end
A1=[A15 A14 A13 A12 A11 ]

for i = 1:1:m
    % 2.调速区间(-)
    % disp('隶属度函数等级为5')
    if x0(i, 2) <= a2
        A25(i, 1) = 1;
    elseif x0(i, 2) > a2 & x0(i, 2) < b2
        A25(i, 1) = (b2 - x0(i, 2)) / (b2 - a2);
    else
        A25(i, 1) = 0;
    end
    % disp('隶属度函数等级为4')
    if x0(i, 2) > a2 & x0(i, 2) < b2
        A24(i, 1) = (x0(i, 2) - a2) / (b2 - a2);
    elseif x0(i, 2) >= b2 & x0(i, 2) < c2
        A24(i, 1) = 1;
    elseif x0(i, 2) >= c2 & x0(i, 2) < d2
        A24(i, 1) = (d2 - x0(i, 2)) / (d2 - c2);
    else
        A24(i, 1) = 0;
    end
    % disp('隶属度函数等级为3')
    if x0(i, 2) > b2 & x0(i, 2) < c2
        A23(i, 1) = (x0(i, 2) - b2) / (c2 - b2);
    elseif x0(i, 2) >= c2 & x0(i, 2) < d2
        A23(i, 1) = 1;
    elseif x0(i, 2) >= d2 & x0(i, 2) < e2
        A23(i, 1) = (e2 - x0(i, 2)) / (e2 - d2);
    else
        A23(i, 1) = 0;
    end
    % disp('隶属度函数等级为2')
    if x0(i, 2) >= c2 & x0(i, 2) < d2
        A22(i, 1) = (x0(i, 2) - c2) / (d2 - c2);
    elseif x0(i, 2) > d2 & x0(i, 2) < e2
        A22(i, 1) = 1;
    elseif x0(i, 2) >= e2 & x0(i, 2) < f2
        A22(i, 1) = (f2 - x0(i, 2)) / (f2 - e2);
    else
        A22(i, 1) = 0;
    end
   % disp('隶属度函数等级为1')
    if x0(i, 2) > e2 & x0(i, 2) < f2
        A21(i, 1) = (x0(i, 2) - e2) / (f2 - e2);
    elseif x0(i, 2) >= f2
        A21(i, 1) = 1;
    else
        A21(i, 1) = 0;
    end
end
A2=[A25 A24 A23 A22 A21 ]


for i = 1:1:m
    % 3.完全结合压力(-)
    % disp('隶属度函数等级为5')
    if x0(i, 3) <= a3
        A35(i, 1) = 1;
    elseif x0(i, 3) > a3 & x0(i, 3) < b3
        A35(i, 1) = (b3 - x0(i, 3)) / (b3 - a3);
    else
        A35(i, 1) = 0;
    end
    % disp('隶属度函数等级为4')
    if x0(i, 3) > a3 & x0(i, 3) < b3
        A34(i, 1) = (x0(i, 3) - a3) / (b3 - a3);
    elseif x0(i, 3) >= b3 & x0(i, 3) < c3
        A34(i, 1) = 1;
    elseif x0(i, 3) >= c3 & x0(i, 3) < d3
        A34(i, 1) = (d3 - x0(i, 3)) / (d3 - c3);
    else
        A34(i, 1) = 0;
    end
    % disp('隶属度函数等级为3')
    if x0(i, 3) > b3 & x0(i, 3) < c3
        A33(i, 1) = (x0(i, 3) - b3) / (c3 - b3);
    elseif x0(i, 3) >= c3 & x0(i, 3) < d3
        A33(i, 1) = 1;
    elseif x0(i, 3) >= d3 & x0(i, 3) < e3
        A33(i, 1) = (e3 - x0(i, 3)) / (e3 - d3);
    else
        A33(i, 1) = 0;
    end
    % disp('隶属度函数等级为2')
    if x0(i, 3) >= c3 & x0(i, 3) < d3
        A32(i, 1) = (x0(i, 3) - c3) / (d3 - c3);
    elseif x0(i, 3) > d3 & x0(i, 3) < e3
        A32(i, 1) = 1;
    elseif x0(i, 3) >= e3 & x0(i, 3) < f3
        A32(i, 1) = (f3 - x0(i, 3)) / (f3 - e3);
    else
        A32(i, 1) = 0;
    end
   % disp('隶属度函数等级为1')
    if x0(i, 3) > e3 & x0(i, 3) < f3
        A31(i, 1) = (x0(i, 3) - e3) / (f3 - e3);
    elseif x0(i, 3) >= f3
        A31(i, 1) = 1;
    else
        A31(i, 1) = 0;
    end
end
A3=[A35 A34 A33 A32 A31 ]

for i = 1:1:m
    % 4.分离压力临界值(-)
    % disp('隶属度函数等级为5')
    if x0(i, 4) <= a4
        A45(i, 1) = 1;
    elseif x0(i, 4) > a4 & x0(i, 4) < b4
        A45(i, 1) = (b4 - x0(i, 4)) / (b4 - a4);
    else
        A45(i, 1) = 0;
    end
    % disp('隶属度函数等级为4')
    if x0(i, 4) > a4 & x0(i, 4) < b4
        A44(i, 1) = (x0(i, 4) - a4) / (b4 - a4);
    elseif x0(i, 4) >= b4 & x0(i, 4) < c4
        A44(i, 1) = 1;
    elseif x0(i, 4) >= c4 & x0(i, 4) < d4
        A44(i, 1) = (d4 - x0(i, 4)) / (d4 - c4);
    else
        A44(i, 1) = 0;
    end
    % disp('隶属度函数等级为3')
    if x0(i, 4) > b4 & x0(i, 4) < c4
        A43(i, 1) = (x0(i, 4) - b4) / (c4 - b4);
    elseif x0(i, 4) >= c4 & x0(i, 4) < d4
        A43(i, 1) = 1;
    elseif x0(i, 4) >= d4 & x0(i, 4) < e4
        A43(i, 1) = (e4 - x0(i, 4)) / (e4 - d4);
    else
        A43(i, 1) = 0;
    end
    % disp('隶属度函数等级为2')
    if x0(i, 4) >= c4 & x0(i, 4) < d4
        A42(i, 1) = (x0(i, 4) - c4) / (d4 - c4);
    elseif x0(i, 4) > d4 & x0(i, 4) < e4
        A42(i, 1) = 1;
    elseif x0(i, 4) >= e4 & x0(i, 4) < f4
        A42(i, 1) = (f4 - x0(i, 4)) / (f4 - e4);
    else
        A42(i, 1) = 0;
    end
   % disp('隶属度函数等级为1')
    if x0(i, 4) > e4 & x0(i, 4) < f4
        A41(i, 1) = (x0(i, 4) - e4) / (f4 - e4);
    elseif x0(i, 4) >= f4
        A41(i, 1) = 1;
    else
        A41(i, 1) = 0;
    end
end
A4=[A45 A44 A43 A42 A41 ]
A=A1.*0.4299+A2.*0.2305+ A3.*0.1670+ A4.*0.1726
% 对每一行进行归一化
A_normalized = zeros(size(A));
for i = 1:size(A, 1)
    row_sum = sum(A(i, :));
    A_normalized(i, :) = A(i, :) / row_sum;
end
score = [100, 75, 50, 25, 0]; % 权重向量，第一列*100，第二列*75，...，第五列*0

% 对归一化后的矩阵 A_normalized 中的每一列分别应用权重
A_score  = A_normalized*score';